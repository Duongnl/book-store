<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{base::layout(~{::section})}">

<head>
	<meta charset="ISO-8859-1">
	<title>View Details</title>
</head>

	<section>
		<div class="container-lg py-5" style="margin-top: 70px; margin-bottom: 100px">
			<div class="row justify-content-center">
				<div class="col-12 col-lg-10">
					<div class="products-card p-4">
						<div class="row g-4 align-items-center">
							<div class="col-md-6">
								<div class="product-image-wrapper bg-white">
									<img th:if="${product.image != null}"
										 th:src="${product.isImageUrl()} ? ${product.image} : @{'/img/product_img/' + product.image}"
										 th:alt="${product.title}"
										 class="product-image">
									<img th:unless="${product.image != null}"
										 th:src="@{/img/product_img/default-product.jpg}"
										 alt="Default product image"
										 class="product-image">
									<span class="discount-badge" th:if="${product.discount > 0}">
										<span class="badge-text">[[${product.discount}]]%</span>
										<span class="badge-label">OFF</span>
									</span>
								</div>
							</div>
							<div class="col-md-6 d-flex flex-column gap-3">
								<h2 class="fw-bold text-primary mb-1">[[${product.title}]]</h2>
								<div class="d-flex align-items-center gap-2 mb-2">
									<span class="badge bg-gradient bg-success bg-opacity-75 px-3 py-2 fs-6">[[${product.stock}]] sản phẩm còn lại</span>
									<span class="badge bg-info text-white">[[${product.category.name}]]</span>
								</div>
								<div class="product-pricing mb-2">
									<span class="price-current">₫[[${product.discountPrice}]]</span>
									<span class="price-original" th:if="${product.discount > 0}">₫[[${product.price}]]</span>
								</div>
								<div class="mb-2">
									<span class="fw-bold">Trạng thái:</span>
									<th:block th:if="${product.stock>0}">
										<span class="badge bg-success">Còn hàng</span>
									</th:block>
									<th:block th:unless="${product.stock>0}">
										<span class="badge bg-warning text-dark">Hết hàng</span>
									</th:block>
								</div>
								<div class="mb-2">
									<span class="fw-bold">Mô tả:</span>
									<span class="text-secondary">[[${product.description}]]</span>
								</div>
								<div class="d-flex justify-content-center gap-4 mb-3">
									<div class="text-success text-center">
										<i class="fas fa-money-bill-wave fa-lg mb-1"></i>
										<div class="small">Thanh toán khi nhận</div>
									</div>
									<div class="text-danger text-center">
										<i class="fas fa-undo-alt fa-lg mb-1"></i>
										<div class="small">Đổi trả 7 ngày</div>
									</div>
									<div class="text-primary text-center">
										<i class="fas fa-truck-moving fa-lg mb-1"></i>
										<div class="small">Miễn phí giao hàng</div>
									</div>
								</div>
								<div>
									<th:block th:if="${product.stock>0}">
										<th:block th:if="${user==null}">
											<a href="/signin" class="btn btn-view-details w-100">Thêm vào giỏ hàng</a>
										</th:block>
										<th:block th:unless="${user==null}">
											<th:block th:if="${user.role=='ROLE_USER'}">
												<a th:href="@{'/user/addCart?pid='+${product.id}+'&uid='+${user.id}}" class="btn btn-view-details w-100">Thêm vào giỏ hàng</a>
											</th:block>
											<th:block th:if="${user.role=='ROLE_ADMIN'}">
												<a th:href="@{'/admin/addCart?pid='+${product.id}+'&uid='+${user.id}}" class="btn btn-view-details w-100">Thêm vào giỏ hàng</a>
											</th:block>
										</th:block>
									</th:block>
									<th:block th:unless="${product.stock>0}">
										<a href="#" class="btn btn-warning w-100 text-white">Hết hàng</a>
									</th:block>
								</div>
								<div class="mt-3">
									<span class="fw-bold">Chính sách:</span> <span class="text-secondary">7 ngày đổi/trả</span>
								</div>
								<th:block th:if="${session.succMsg}">
									<p class="text-success alert alert-success text-center mt-4" role="alert">[[${session.succMsg}]]</p>
									<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
								</th:block>
								<th:block th:if="${session.errorMsg}">
									<p class="text-danger text-center alert alert-danger mt-4">[[${session.errorMsg}]]</p>
									<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
								</th:block>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>